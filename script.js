document.addEventListener("DOMContentLoaded",()=>{const input=document.getElementById("input"),result=document.getElementById("result"),button=document.getElementById("btn");let shortUrl=null;button.addEventListener("click",()=>{if(!shortUrl){const longUrl=input.value.trim();if(!longUrl)return;button.textContent="Converting...";fetch("https://tinyurl.com/api-create.php?url="+encodeURIComponent(longUrl)).then(r=>r.text()).then(url=>{shortUrl=url;result.innerHTML=`<a href="${shortUrl}" target="_blank">${shortUrl}</a>`;button.textContent="Copy"}).catch(()=>{result.textContent="Error";button.textContent="Convert"})}else navigator.clipboard.writeText(shortUrl).then(()=>{button.textContent="Copied!";setTimeout(()=>button.textContent="Copy",1000)}).catch(()=>alert("Copy failed"))});input.addEventListener("input",()=>{shortUrl=null;result.textContent="";button.textContent="Convert"})})